<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
>
<h:head>
    <title>JSF 2.3: Websocket Sample</title>
</h:head>
<h:body>
    <div>
<!--        <h:form rendered="false">-->
<!--            <h:inputHidden value="#{ajaxBean}"/>-->
<!--        </h:form>-->
        <h:dataTable var="row" value="#{scheduleService.getSchedule()}"
                     id="scheduleTable"
                     styleClass="simpletablestyle">
            <h:column>
                <f:facet name="header">routeNumber</f:facet>
                #{row.routeNumber}
            </h:column>
            <h:column>
                <f:facet name="header">routeName</f:facet>
                #{row.routeName}
            </h:column>
            <h:column>
                <f:facet name="header">canceled</f:facet>
                #{row.canceled}
                <!--                <c:choose>-->
                <!--                    <c:when test="#{row.canceled}">Отменен</c:when>-->
                <!--                    <c:otherwise>Активен</c:otherwise>-->
                <!--                </c:choose>-->
            </h:column>
            <h:column>
                <f:facet name="header">delay</f:facet>
                #{row.delay}
            </h:column>
            <h:column>
                <f:facet name="header">arrival</f:facet>
                #{row.arrival}
            </h:column>
            <h:column>
                <f:facet name="header">departure</f:facet>
                #{row.departure}
            </h:column>
        </h:dataTable>
    </div>

    <h:form id="form">
        <h:commandButton
                id="pushToAjaxChannel"
                action="#{ajaxBean.pushToAjaxChannel()}"
                value="pushToAjaxChannel">
            <f:ajax/>
        </h:commandButton>
        <h:commandButton
                id="pushToAjaxListenerChannel"
                action="#{ajaxBean.pushToAjaxListenerChannel()}"
                value="pushToAjaxListenerChannel">
            <f:ajax/>
        </h:commandButton>
    </h:form>
    <h:form>
        <f:websocket channel="ajaxChannel" scope="view">
            <f:ajax event="ajaxEvent" render=":scheduleTable"/>
        </f:websocket>
    </h:form>
    <h:form>
        <f:websocket channel="ajaxListenerChannel" scope="view">
            <f:ajax event="ajaxListenerEvent" listener="#{ajaxBean.ajaxPushed}" render=":scheduleTable"/>
        </f:websocket>
    </h:form>

</h:body>
</html>